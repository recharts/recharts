import{r as o,i as M,p as W}from"./iframe-BjYhBrjl.js";import{r as z,c as _,b as U}from"./resolveDefaultProps-CW-CYJ5T.js";import{a3 as H,a4 as j}from"./axisSelectors-DEfYHCC1.js";import{L as D}from"./Layer-DXlUs9xn.js";import{T as L}from"./Text-BkZHxLFB.js";import{u as A,b as R,O as Y,P as $,q as G}from"./arrayEqualityCheck-CNWOZzwZ.js";import{u as J,a as Q}from"./chartDataContext-BU8YO9rr.js";import{z as F,A as V,B as Z}from"./RechartsWrapper-kzv9It-X.js";const ee=["Webkit","Moz","O","ms"],te=(a,n)=>{const t=a.replace(/(\w)/,r=>r.toUpperCase()),e=ee.reduce((r,s)=>({...r,[s+t]:n}),{});return e[a]=n,e},ne=o.createContext(()=>{});function re(a){const{x:n,y:t,width:e,height:r,stroke:s}=a,l=Math.floor(t+r/2)-1;return o.createElement(o.Fragment,null,o.createElement("rect",{x:n,y:t,width:e,height:r,fill:s,stroke:"none"}),o.createElement("line",{x1:n+1,y1:l,x2:n+e-1,y2:l,fill:"none",stroke:"#fff"}),o.createElement("line",{x1:n+1,y1:l+2,x2:n+e-1,y2:l+2,fill:"none",stroke:"#fff"}))}function ae(a){const{travellerProps:n,travellerType:t}=a;return o.isValidElement(t)?o.cloneElement(t,n):typeof t=="function"?t(n):o.createElement(re,{...n})}function P(a){if(W(a)&&typeof a=="object"&&"name"in a&&typeof a.name=="string")return a.name}function se(a,n,t){const e=P(a[n]),r=P(a[t]);return`Min value: ${e}, Max value: ${r}`}function B({otherProps:a,travellerX:n,id:t,onMouseEnter:e,onMouseLeave:r,onMouseDown:s,onTouchStart:l,onTravellerMoveKeyboard:i,onFocus:d,onBlur:u}){const{y:f,x:h,travellerWidth:c,height:v,traveller:m,ariaLabel:p,data:g,startIndex:T,endIndex:x}=a,y=Math.max(n,h),I={...U(a),x:y,y:f,width:c,height:v},S=p||se(g,T,x);return o.createElement(D,{tabIndex:0,role:"slider","aria-label":S,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:e,onMouseLeave:r,onMouseDown:s,onTouchStart:l,onKeyDown:E=>{["ArrowLeft","ArrowRight"].includes(E.key)&&(E.preventDefault(),E.stopPropagation(),i(E.key==="ArrowRight"?1:-1,t))},onFocus:d,onBlur:u,style:{cursor:"col-resize"}},o.createElement(ae,{travellerType:m,travellerProps:I}))}function C(a){const{index:n,data:t,tickFormatter:e,dataKey:r}=a,s=G(t[n],r,n);return typeof e=="function"?e(s,n):s}function k(a,n){const t=a.length;let e=0,r=t-1;for(;r-e>1;){const l=Math.floor((e+r)/2),i=a[l];i!=null&&i>n?r=l:e=l}const s=a[r];return s!=null&&n>=s?r:e}function X({startX:a,endX:n,scaleValues:t,gap:e,data:r}){const s=r.length-1,l=Math.min(a,n),i=Math.max(a,n),d=k(t,l),u=k(t,i);return{startIndex:d-d%e,endIndex:u===s?s:u-u%e}}function le({x:a,y:n,width:t,height:e,fill:r,stroke:s}){return o.createElement("rect",{stroke:s,fill:r,x:a,y:n,width:t,height:e})}function ie({startIndex:a,endIndex:n,y:t,height:e,travellerWidth:r,stroke:s,tickFormatter:l,dataKey:i,data:d,startX:u,endX:f}){const c={pointerEvents:"none",fill:s};return o.createElement(D,{className:"recharts-brush-texts"},o.createElement(L,{textAnchor:"end",verticalAnchor:"middle",x:Math.min(u,f)-5,y:t+e/2,...c},C({index:a,tickFormatter:l,dataKey:i,data:d})),o.createElement(L,{textAnchor:"start",verticalAnchor:"middle",x:Math.max(u,f)+r+5,y:t+e/2,...c},C({index:n,tickFormatter:l,dataKey:i,data:d})))}function oe({y:a,height:n,stroke:t,travellerWidth:e,startX:r,endX:s,onMouseEnter:l,onMouseLeave:i,onMouseDown:d,onTouchStart:u}){const f=Math.min(r,s)+e,h=Math.max(Math.abs(s-r)-e,0);return o.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:l,onMouseLeave:i,onMouseDown:d,onTouchStart:u,style:{cursor:"move"},stroke:"none",fill:t,fillOpacity:.2,x:f,y:a,width:h,height:n})}function de({x:a,y:n,width:t,height:e,data:r,children:s,padding:l}){if(!(o.Children.count(s)===1))return null;const d=o.Children.only(s);return d?o.cloneElement(d,{x:a,y:n,width:t,height:e,margin:l,compact:!0,data:r}):null}const he=({data:a,startIndex:n,endIndex:t,x:e,width:r,travellerWidth:s})=>{if(!a||!a.length)return{};const l=a.length,i=H().domain(j(0,l)).range([e,e+r-s]),d=i.domain().map(u=>i(u)).filter(W);return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:i(n),endX:i(t),scale:i,scaleValues:d}},O=a=>a.changedTouches&&!!a.changedTouches.length;class ue extends o.PureComponent{constructor(n){super(n),this.handleDrag=t=>{this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.state.isTravellerMoving?this.handleTravellerMove(t):this.state.isSlideMoving&&this.handleSlideDrag(t)},this.handleTouchMove=t=>{var r;const e=(r=t.changedTouches)==null?void 0:r[0];e!=null&&this.handleDrag(e)},this.handleDragEnd=()=>{this.setState({isTravellerMoving:!1,isSlideMoving:!1},()=>{const{endIndex:t,onDragEnd:e,startIndex:r}=this.props;e==null||e({endIndex:t,startIndex:r})}),this.detachDragEndListener()},this.handleLeaveWrapper=()=>{(this.state.isTravellerMoving||this.state.isSlideMoving)&&(this.leaveTimer=window.setTimeout(this.handleDragEnd,this.props.leaveTimeOut))},this.handleEnterSlideOrTraveller=()=>{this.setState({isTextActive:!0})},this.handleLeaveSlideOrTraveller=()=>{this.setState({isTextActive:!1})},this.handleSlideDragStart=t=>{const e=O(t)?t.changedTouches[0]:t;e!=null&&(this.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:e.pageX}),this.attachDragEndListener())},this.handleTravellerMoveKeyboard=(t,e)=>{const{data:r,gap:s,startIndex:l,endIndex:i}=this.props,{scaleValues:d,startX:u,endX:f}=this.state;if(d==null)return;let h=-1;if(e==="startX"?h=l:e==="endX"&&(h=i),h<0||h>=r.length)return;const c=h+t;if(c===-1||c>=d.length)return;const v=d[c];v!=null&&(e==="startX"&&v>=f||e==="endX"&&v<=u||this.setState({[e]:v},()=>{this.props.onChange(X({startX:this.state.startX,endX:this.state.endX,data:r,gap:s,scaleValues:d}))}))},this.travellerDragStartHandlers={startX:this.handleTravellerDragStart.bind(this,"startX"),endX:this.handleTravellerDragStart.bind(this,"endX")},this.state={brushMoveStartX:0,movingTravellerId:void 0,endX:0,startX:0,slideMoveStartX:0}}static getDerivedStateFromProps(n,t){const{data:e,width:r,x:s,travellerWidth:l,startIndex:i,endIndex:d,startIndexControlledFromProps:u,endIndexControlledFromProps:f}=n;if(e!==t.prevData)return{prevData:e,prevTravellerWidth:l,prevX:s,prevWidth:r,...e&&e.length?he({data:e,width:r,x:s,travellerWidth:l,startIndex:i,endIndex:d}):{scale:void 0,scaleValues:void 0}};const h=t.scale;if(h&&(r!==t.prevWidth||s!==t.prevX||l!==t.prevTravellerWidth)){h.range([s,s+r-l]);const c=h.domain().map(v=>h(v)).filter(v=>v!=null);return{prevData:e,prevTravellerWidth:l,prevX:s,prevWidth:r,startX:h(n.startIndex),endX:h(n.endIndex),scaleValues:c}}if(t.scale&&!t.isSlideMoving&&!t.isTravellerMoving&&!t.isTravellerFocused&&!t.isTextActive){if(u!=null&&t.prevStartIndexControlledFromProps!==u)return{startX:t.scale(u),prevStartIndexControlledFromProps:u};if(f!=null&&t.prevEndIndexControlledFromProps!==f)return{endX:t.scale(f),prevEndIndexControlledFromProps:f}}return null}componentWillUnmount(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}attachDragEndListener(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}detachDragEndListener(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}handleSlideDrag(n){const{slideMoveStartX:t,startX:e,endX:r,scaleValues:s}=this.state;if(s==null)return;const{x:l,width:i,travellerWidth:d,startIndex:u,endIndex:f,onChange:h,data:c,gap:v}=this.props;let m=n.pageX-t;m>0?m=Math.min(m,l+i-d-r,l+i-d-e):m<0&&(m=Math.max(m,l-e,l-r));const p=X({startX:e+m,endX:r+m,data:c,gap:v,scaleValues:s});(p.startIndex!==u||p.endIndex!==f)&&h&&h(p),this.setState({startX:e+m,endX:r+m,slideMoveStartX:n.pageX})}handleTravellerDragStart(n,t){const e=O(t)?t.changedTouches[0]:t;e!=null&&(this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:e.pageX}),this.attachDragEndListener())}handleTravellerMove(n){const{brushMoveStartX:t,movingTravellerId:e,endX:r,startX:s,scaleValues:l}=this.state;if(e==null||l==null)return;const i=this.state[e],{x:d,width:u,travellerWidth:f,onChange:h,gap:c,data:v}=this.props,m={startX:this.state.startX,endX:this.state.endX,data:v,gap:c,scaleValues:l};let p=n.pageX-t;p>0?p=Math.min(p,d+u-f-i):p<0&&(p=Math.max(p,d-i)),m[e]=i+p;const g=X(m),{startIndex:T,endIndex:x}=g,y=()=>{const I=v.length-1;return e==="startX"&&(r>s?T%c===0:x%c===0)||r<s&&x===I||e==="endX"&&(r>s?x%c===0:T%c===0)||r>s&&x===I};this.setState({[e]:i+p,brushMoveStartX:n.pageX},()=>{h&&y()&&h(g)})}render(){const{data:n,className:t,children:e,x:r,y:s,dy:l,width:i,height:d,alwaysShowText:u,fill:f,stroke:h,startIndex:c,endIndex:v,travellerWidth:m,tickFormatter:p,dataKey:g,padding:T}=this.props,{startX:x,endX:y,isTextActive:I,isSlideMoving:S,isTravellerMoving:E,isTravellerFocused:N}=this.state;if(!n||!n.length||!M(r)||!M(s)||!M(i)||!M(d)||i<=0||d<=0)return null;const q=_("recharts-brush",t),K=te("userSelect","none"),w=s+(l??0);return o.createElement(D,{className:q,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:K},o.createElement(le,{x:r,y:w,width:i,height:d,fill:f,stroke:h}),o.createElement($,null,o.createElement(de,{x:r,y:w,width:i,height:d,data:n,padding:T},e)),o.createElement(oe,{y:w,height:d,stroke:h,travellerWidth:m,startX:x,endX:y,onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart}),o.createElement(B,{travellerX:x,id:"startX",otherProps:{...this.props,y:w},onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers.startX,onTouchStart:this.travellerDragStartHandlers.startX,onTravellerMoveKeyboard:this.handleTravellerMoveKeyboard,onFocus:()=>{this.setState({isTravellerFocused:!0})},onBlur:()=>{this.setState({isTravellerFocused:!1})}}),o.createElement(B,{travellerX:y,id:"endX",otherProps:{...this.props,y:w},onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers.endX,onTouchStart:this.travellerDragStartHandlers.endX,onTravellerMoveKeyboard:this.handleTravellerMoveKeyboard,onFocus:()=>{this.setState({isTravellerFocused:!0})},onBlur:()=>{this.setState({isTravellerFocused:!1})}}),(I||S||E||N||u)&&o.createElement(ie,{startIndex:c,endIndex:v,y:w,height:d,travellerWidth:m,stroke:h,tickFormatter:p,dataKey:g,data:n,startX:x,endX:y}))}}function ce(a){const n=A(),t=J(),e=Q(),r=o.useContext(ne),s=a.onChange,{startIndex:l,endIndex:i}=a;o.useEffect(()=>{n(V({startIndex:l,endIndex:i}))},[n,i,l]),Z();const d=o.useCallback(g=>{if(e==null)return;const{startIndex:T,endIndex:x}=e;(g.startIndex!==T||g.endIndex!==x)&&(r==null||r(g),s==null||s(g),n(V(g)))},[s,r,n,e]),u=R(Y);if(u==null||e==null||t==null||!t.length)return null;const{startIndex:f,endIndex:h}=e,{x:c,y:v,width:m}=u,p={data:t,x:c,y:v,width:m,startIndex:f,endIndex:h,onChange:d};return o.createElement(ue,{...a,...p,startIndexControlledFromProps:l??void 0,endIndexControlledFromProps:i??void 0})}function fe(a){const n=A();return o.useEffect(()=>(n(F(a)),()=>{n(F(null))}),[n,a]),null}const me={height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1};function b(a){const n=z(a,me);return o.createElement(o.Fragment,null,o.createElement(fe,{height:n.height,x:n.x,y:n.y,width:n.width,padding:n.padding}),o.createElement(ce,{...n}))}b.displayName="Brush";try{b.displayName="Brush",b.__docgenInfo={description:`Renders a scrollbar that allows the user to zoom and pan in the chart along its XAxis.
It also allows you to render a small overview of the chart inside the brush that is always visible
and shows the full data set so that the user can see where they are zoomed in.

If a chart is synchronized with other charts using the \`syncId\` prop on the chart,
the brush will also synchronize the zooming and panning between all synchronized charts.`,displayName:"Brush",props:{ariaLabel:{defaultValue:null,description:"",name:"ariaLabel",required:!1,type:{name:"string"}},travellerWidth:{defaultValue:null,description:`The width of each traveller.
@defaultValue 5`,name:"travellerWidth",required:!1,type:{name:"number"}},traveller:{defaultValue:null,description:"",name:"traveller",required:!1,type:{name:"BrushTravellerType"}},gap:{defaultValue:null,description:`Number of data points to skip between chart refreshes.
@defaultValue 1`,name:"gap",required:!1,type:{name:"number"}},padding:{defaultValue:null,description:"",name:"padding",required:!1,type:{name:"Padding"}},dataKey:{defaultValue:null,description:"Decides how to extract the value of this Brush from the data:\n- `string`: the name of the field in the data object;\n- `number`: the index of the field in the data;\n- `function`: a function that receives the data object and returns the value of this Brush.",name:"dataKey",required:!1,type:{name:"DataKey<any>"}},startIndex:{defaultValue:null,description:`The default start index of brush.
If the option is not set, the start index will be 0.`,name:"startIndex",required:!1,type:{name:"number"}},endIndex:{defaultValue:null,description:`The default end index of brush.
If the option is not set, the end index will be calculated by the length of data.`,name:"endIndex",required:!1,type:{name:"number"}},tickFormatter:{defaultValue:null,description:"The formatter function of ticks.",name:"tickFormatter",required:!1,type:{name:"BrushTickFormatter"}},onChange:{defaultValue:null,description:"The handler of changing the active scope of brush.",name:"onChange",required:!1,type:{name:"OnBrushUpdate"}},onDragEnd:{defaultValue:null,description:"",name:"onDragEnd",required:!1,type:{name:"OnBrushUpdate"}},leaveTimeOut:{defaultValue:null,description:"@defaultValue 1000",name:"leaveTimeOut",required:!1,type:{name:"number"}},alwaysShowText:{defaultValue:null,description:"@defaultValue false",name:"alwaysShowText",required:!1,type:{name:"boolean"}}}}}catch{}export{b as B};
