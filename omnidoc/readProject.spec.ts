import { describe, it, expect } from 'vitest';
import { SymbolFlags } from 'ts-morph';
import { ProjectDocReader } from './readProject';

describe('readProject', () => {
  const reader = new ProjectDocReader();
  it('should identify all exported symbols', () => {
    expect(reader.getPublicSymbolNames()).toMatchInlineSnapshot(`
      [
        "Area",
        "AreaChart",
        "AreaProps",
        "Bar",
        "BarChart",
        "BarProps",
        "Brush",
        "BrushProps",
        "CartesianAxis",
        "CartesianAxisProps",
        "CartesianGrid",
        "CartesianGridProps",
        "Cell",
        "CellProps",
        "ChartOffset",
        "ComposedChart",
        "Cross",
        "CrossProps",
        "Curve",
        "CurveProps",
        "Customized",
        "CustomizedProps",
        "DefaultLegendContent",
        "DefaultLegendContentProps",
        "DefaultTooltipContent",
        "DefaultTooltipContentProps",
        "Dot",
        "DotItemDotProps",
        "DotProps",
        "ErrorBar",
        "ErrorBarProps",
        "Funnel",
        "FunnelChart",
        "FunnelProps",
        "FunnelTrapezoidItem",
        "getNiceTickValues",
        "Global",
        "Label",
        "LabelList",
        "LabelListProps",
        "LabelProps",
        "Layer",
        "LayerProps",
        "Legend",
        "LegendPayload",
        "LegendProps",
        "LegendType",
        "Line",
        "LineChart",
        "LineProps",
        "MouseHandlerDataParam",
        "Pie",
        "PieChart",
        "PieLabel",
        "PieLabelRenderProps",
        "PieProps",
        "PieSectorDataItem",
        "PlotArea",
        "PolarAngleAxis",
        "PolarAngleAxisProps",
        "PolarGrid",
        "PolarGridProps",
        "PolarRadiusAxis",
        "PolarRadiusAxisProps",
        "Polygon",
        "PolygonProps",
        "Radar",
        "RadarChart",
        "RadarProps",
        "RadialBar",
        "RadialBarChart",
        "RadialBarProps",
        "Rectangle",
        "RectangleProps",
        "ReferenceArea",
        "ReferenceAreaProps",
        "ReferenceDot",
        "ReferenceDotProps",
        "ReferenceLine",
        "ReferenceLineProps",
        "ResponsiveContainer",
        "ResponsiveContainerProps",
        "Sankey",
        "Scatter",
        "ScatterChart",
        "ScatterProps",
        "Sector",
        "SectorProps",
        "SunburstChart",
        "Surface",
        "SurfaceProps",
        "Symbols",
        "SymbolsProps",
        "Text",
        "TextProps",
        "Tooltip",
        "TooltipContentProps",
        "TooltipProps",
        "Trapezoid",
        "TrapezoidProps",
        "Treemap",
        "TreemapProps",
        "useActiveTooltipDataPoints",
        "useActiveTooltipLabel",
        "useChartHeight",
        "useChartWidth",
        "useMargin",
        "useOffset",
        "usePlotArea",
        "useXAxisDomain",
        "useYAxisDomain",
        "XAxis",
        "XAxisProps",
        "YAxis",
        "YAxisProps",
        "ZAxis",
        "ZAxisProps",
      ]
    `);
  });

  it('should filter symbols by kind', () => {
    // this is a list of exported runtime objects, looks useful. Where is ZAxis though? Maybe ZAxis is a function.
    expect(reader.getPublicSymbolNames(SymbolFlags.Variable)).toMatchInlineSnapshot(`
      [
        "Area",
        "AreaChart",
        "Bar",
        "BarChart",
        "CartesianAxis",
        "Cell",
        "ComposedChart",
        "Cross",
        "Curve",
        "DefaultLegendContent",
        "DefaultTooltipContent",
        "Dot",
        "FunnelChart",
        "getNiceTickValues",
        "Global",
        "Layer",
        "Line",
        "LineChart",
        "PieChart",
        "PolarGrid",
        "Polygon",
        "RadarChart",
        "RadialBarChart",
        "Rectangle",
        "ResponsiveContainer",
        "Scatter",
        "ScatterChart",
        "Sector",
        "SunburstChart",
        "Surface",
        "Symbols",
        "Text",
        "Trapezoid",
        "useActiveTooltipDataPoints",
        "useActiveTooltipLabel",
        "useChartHeight",
        "useChartWidth",
        "useMargin",
        "useOffset",
        "usePlotArea",
        "useXAxisDomain",
        "useYAxisDomain",
        "XAxis",
        "YAxis",
      ]
    `);
  });

  it('should return properties', () => {
    // this is not entirely helpful for what we need to do
    expect(reader.getPropertiesOf('Funnel')).toMatchInlineSnapshot(`
      [
        "render",
        "context",
        "setState",
        "forceUpdate",
        "props",
        "state",
        "refs",
        "componentDidMount",
        "shouldComponentUpdate",
        "componentWillUnmount",
        "componentDidCatch",
        "getSnapshotBeforeUpdate",
        "componentDidUpdate",
        "componentWillMount",
        "UNSAFE_componentWillMount",
        "componentWillReceiveProps",
        "UNSAFE_componentWillReceiveProps",
        "componentWillUpdate",
        "UNSAFE_componentWillUpdate",
      ]
    `);
  });

  it('should return props', () => {
    expect(reader.getPropsOf('ReferenceLine')).toMatchInlineSnapshot(`
      [
        "className",
        "ifOverflow",
        "label",
        "position",
        "segment",
        "shape",
        "x",
        "xAxisId",
        "y",
        "yAxisId",
        "zIndex",
      ]
    `);
  });

  it('should return SVG component that this component extends', () => {
    expect(reader.getSVGParentOf('ReferenceLine')).toBe('SVGLineElement');
  });
});
